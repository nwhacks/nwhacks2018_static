<html><head></head><body><dom-module id="admin-blacklist-page"><template><style include="light-page">#input{display:flex;align-items:center;}paper-input{flex-grow:10000;}h1{padding-top:1em;}</style><h1 title="">Blacklist</h1><table><thead><tr><th>Name</th><th>Email</th><th>Date</th><th>Reason</th></tr></thead><tbody><template is="dom-repeat" items="[[list(blacklist, blacklist.*)]]"><tr><td>[[item.body.name]]</td><td><a href="mailto:[[item.email]]">[[item.email]]</a></td><td>[[ago(item.body.date)]]</td><td>[[item.body.reason]]</td><td><paper-icon-button icon="delete-forever" on-tap="delete"></paper-icon-button></td></tr><tr></tr></template></tbody></table><h2>Add</h2><div id="input"><paper-input label="Name" required="" type="name" auto-validate="" value="{{name}}"></paper-input>&nbsp;<paper-input label="Email" required="" type="email" auto-validate="" value="{{email}}"></paper-input>&nbsp;<paper-input label="Reason" required="" type="text" auto-validate="" value="{{reason}}"></paper-input>&nbsp;<paper-button on-tap="submit">Add entry</paper-button></div><template is="dom-if" if="[[isAdmin]]"><firebase-document path="/admin/blacklist" data="{{blacklist}}"></firebase-document></template></template><script>var AdminBlacklistPage=function(_Polymer$Element){babelHelpers.inherits(AdminBlacklistPage,_Polymer$Element);function AdminBlacklistPage(){babelHelpers.classCallCheck(this,AdminBlacklistPage);return babelHelpers.possibleConstructorReturn(this,(AdminBlacklistPage.__proto__||Object.getPrototypeOf(AdminBlacklistPage)).apply(this,arguments))}babelHelpers.createClass(AdminBlacklistPage,[{key:"list",value:function list(entries){for(var l=[],_arr=Object.keys(entries),_i=0,id;_i<_arr.length;_i++){id=_arr[_i];l.push({id:id,email:unescape(id),body:entries[id]})}return l}},{key:"ago",value:function ago(time){if(!time){return"never"}return moment(time).fromNow()}},{key:"validate",value:function validate(){var valid=!0,_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _iterator=this.$.input.children[Symbol.iterator](),_step,e;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){e=_step.value;if(e.validate&&!e.validate()){valid=!1}}}catch(err){_didIteratorError=!0;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&null!=_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return valid}},{key:"formatEmail",value:function formatEmail(email){if(!email){return}return email.replace(/\./g,"%2E")}},{key:"submit",value:function submit(){if(!this.validate()){return}var email=this.email.toLowerCase();this.set(["blacklist",this.formatEmail(email)],{name:this.name,email:email,reason:this.reason,date:firebase.database.ServerValue.TIMESTAMP});this.name="";this.email="";this.reason=""}},{key:"delete",value:function _delete(e){var entry=e.model.item,name=entry.body.name||"";if(!confirm("Remove from blacklist "+name+" ("+entry.email+")?")){return}this.set(["blacklist",entry.id],null)}}],[{key:"is",get:function get(){return"admin-blacklist-page"}}]);return AdminBlacklistPage}(Polymer.Element);customElements.define(AdminBlacklistPage.is,AdminBlacklistPage);</script></dom-module></body></html>